# 가상 메모리   

- 사용자와 논리적 주소를 물리적으로 분리한 후 **사용자가 메인 메모리 용량을 초과한 프로세스에 주소를 지정해 메모리를 제한 없이 사용할 수 있도록 하는 개념**  
- 다중 프로그래밍 환경에서 흔히 사용. 메인 메모리보다 더 큰 저장 공간을 제공하는 방법   
- 각 프로세스에 균일한 주소 공간을 제공해 **메모리 관리가 단순, 메인 메모리를 더 효율적으로 사용 가능**   
- 매핑: 가상 주소를 물리적 주소롤 변환하는 과정  

## 요구 페이징  

- 프로그램 실행을 위해 프로그램의 일부만 메인 메모리에 적재  
- 메인 메모리와 디스크 간의 과도한 페이지 교체로 오버헤드를 증가시켜 시스템의 성능을 떨어뜨린다는 단점이 있음  

## 페이지 부재<sup>page fault</sup>
 저장하지 않은 페이지를 사용하려고 할 때 나타나는 현상  

## 페이지 대치  
- 페이지 부재가 발생하면 메인 메모리에 있으면서 사용하지 않는 페이지를 디스크로 내보내고 새로운 페이지로 바꾸는 과정  
- 내보낼 페이지를 고를 때는 페이지 부재 비율이 가장 낮은 알고리즘을 선택  

### 선입선출 대치 알고리즘  
- 가장 들어간지 오래된 페이지부터 우선 대치  
- 벨래디의 변이 현상 때문에 문제가 있음  

> **벨래디의 변이<sup>Belady's anomaly</sup>**  
할당하는 프레임 수가 증가하면 페이지 부재 비율도 증가하는 현상   

### 최적 페이지 대치 알고리즘   
- 앞으로 가장 오랫동안 사용하지 않을 페이지를 대치
- 모든 알고리즘 가운데 페이지 부재 비율이 가장 낮다.   
- 참조 문자열을 정확하게 언제 사용할지 정보를 요구하는데 이것은 알기가 어렵기 때문에 비교용으로 사용   

### 최근 최소 사용 대치 알고리즘  
- 하드웨어를 지원해야 한다.  

### 최근 최소 사용 근접 알고리즘  

- 상당수 시스템이 참조 비트의 형태를 지원  
 - 시계(2차적 기회 대치) 알고리즘  
 - NUR<sup>Not Used Recently</sup> 알고리즘  
 - 최소 사용 빈도수<sup>LFU, Least Frequently Used</sup> 알고리즘  
 - 최대 사용 빈도수<sup>MFU, Most Frequently Used</sup> 알고리즘  
 - 페이지 버퍼링  

### 프레임 할당 알고리즘  
- 균일 프레임 할당 알고리즘: 각 프로세스에 똑같이 프레임을 m/n개씩 할당하는 방법   
- 비례 프레임 할당 알고리즘: 사용 가능한 메모리를 각 프로세스의 크기에 비례하여 할당하는 방법  

## 스래싱  

- 페이지 교환이 계속 일어나는 현상  
 - 어떤 프로세스가 현재 작업 집합에서 프레임이 충분하지 않을 때 발생  
 - 각 프로세스에 충분한 프레임을 주거나 적절하게 스케줄링하여 방지할 수 있다.  
- 작업 집합<sup>working set</sup> 모델  
- 지역 모델  

## 지역성(구역성)  
- 프로세스는 어느 실행 단계 동안 메모리의 정보를 균일하게 액세스하는 것이 아니라 선호하는 특정 페이지만 집중적으로 참조하는 현상   
 **- 시간 지역성:** 순환(루프), 서브 프로그램, 스택, 계산이나 합계에 사용하는 변수  
 **- 공간 지역성:** 배열 검색(순회), 순차적 코드의 실행, 근처의 관련 변수 선언   

## 작업 집합 모델  
- 프로세스가 많이 참조하는 페이지 집합을 메모리 공간에 계속 상주시켜 빈번한 페이지 대치 현상을 줄이도록 프로그램의 수행 과정ㅇ르 지역성으로 설명하는 모델  
 - 작업 집합 크기가 작고 페이지 프레임 수가 적으면, 페이지 부재 비율이 높아 스래싱 현상을 일으킬 수 있다.  
 - 작업 집합 크기가 크고 페이지 프레임 수가 많으면, 프로세스의 실제 작업 페이지와 다른 페이지까지 메모리를 차지하여 메모리 낭비와 다중 ㅇ프로그래밍 정도를 감소시킬 수 있다.  

## 페이지 부재 비율  
- 페이지 부재 비율<sup>PFF, Page Fault Frequency</sup>은 스래싱을 예방하는 직접적인 액세스 방법  
- 페이지 환경에서 프로세스의 실행을 측정하는 기준  
- PFF가 상한 값을 넘으면 프로세스에 다른 프레임을 더 할당, 낮으면 프레임을 회수   

## 시스템 성능을 향상시키는 기타 이슈  

- 전역 대치: 프레임 할당 기준으로 페이지 대치 범위를 모든 프로세스에 적용  
- 지역 대치: 프로세스를 개별적으로 제한  
- 프리 페이징: 예상되는 모든 페이지를 사전에 한꺼번에 메모리로 가져오는 방법   
- 페이지 테이블의 크기, 페이지 테이블의 구조등도 고려  

 



