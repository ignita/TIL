# 환경

- 쉘은 쉘 세션이 진행되는 동안 모든 정보를 관리하는 **환경**을 유지  
 - 쉘 환경에 저장된 데이터는 설정 프로그램에 의해 사용됨.  
 - 대부분의 프로그램은 **환경설정 파일**을 사용, 일부 프로그램은 동작을 위해 환경에 설정된 값을 찾아보기도 함.  

- 명령어  
 - `printenv` - 환경 일부 또는 전체 출력  
 - `set` - 쉘 옵션 설정  
 - `export` - 다음 실행 프로그램에 환경 적용  
 - `alias` - 명령어 별칭 생성  

## 환경에는 어떤 것들이 저장될까?  

- 쉘은 두 가지 기본적인 형식을 저장  

 - **쉘 변수** - bash에 저장된 작은 데이터
 - **환경 변수** - 그 밖의 모든 것  
 - **별칭**, **쉘 함수**와 같은 프로그램 데이터

### 환경 검증하기

- set - 쉘 변수와 환경 변수 출력  
- printenv - 환경 변수만 출력  

```
[me@linuxbox ~]$ printenv USER
me
```
- printenv 명령으로 특수한 변수의 값을 나열 가능  
- printenv와 달리 set은 알파벳순으로 결과를 정렬, echo 명령어로 변수 내용 확인도 가능  
```
[me@linuxbox ~]$ echo $HOME
/home/me
```
- set이나 printenv 명령어가 표시하지 않는 하나의 환경 요소는 별칭. 이를 보려면 alias 명령을 인자 없이 입력하면 된다.  

### 흥미로운 몇 가지 변수들  

| 변수 | 내용 | 
| --- | --- |
| DISPLAY | 그래픽 환경 사용자인 경우 디스플레이명. 보통은 :0, X서버에 의해 생성된 가장 첫 번째 디스플레이라는 뜻 |  
| EDITOR | 텍스트 편집에 기본적으로 사용되는 프로그램명 |  
| SHELL | 사용자의 쉘 프로그램명 | 
| HOME | 홈 디렉토리 경로명 | 
| LANG | 사용자 언어의 문자셋과 정렬 방식 정의 |
| OLD_PWD | 이전 작업 디렉토리 | 
| PAGER | 페이지 출력에 사용되는 프로그램명. 주로 /usr/bin/less 가 정의 |
| PATH | 실행 프로그램명을 입력할 때, 그 이름을 찾는 디렉토리 목록(콜론으로 구분) | 
| PS1 | 프롬프트 문자열 1. 쉘 프롬프트 내용을 정의 |  
| TERM | 사용자 터미널 타입 이름 | 
| TZ | 사용자의 시간대 설정 | 
| USER | 사용자명 |  

## 환경은 어떻게 설정할까?  

- 시스템에 로그인하면 bash 프로그램이 시작되면서 **시작 파일**(startup files)라고 하는 일련의 환경 설정 스크립트를 읽는다. 
 - 시작 파일은 모든 사용자에게 공유되는 기본적인 환경설정 값을 규정  
 - 이어서 사용자의 환경을 정의하는 홈 디렉토리 내의 시작 파일이 구성된다.  

### 로그인 여부에 따른 쉘 환경  

- **로그인 쉘 세션** - 사용자 이름과 비밀번호를 입력하도록 되어 있다. 예를 들면 가상 콘솔 세션이 시작할 때..  
 - 로그인 쉘 세션용 시작 파일  

  | 파일 | 내용 |  
  | --- | --- |
  | _/etc/profile_ | 모든 사용자에게 적용되는 일반 환경설정 | 
  | _~/.bash_profile_ | 개인 사용자 시작 파일. 일반 환경설정을 확장하거나 무시 가능 |  
  | _~/.bash_login_ | _~/.bash_profile_ 파일이 없으면 bash는 이 스크립트를 읽게 된다. | 
  | _~/.profile_  | _~/.bash_profile_이나 _~/.bash_login_ 모두 없으면 이 파일을 읽는다. |  


- **비로그인 쉘 세션** - 일반적으로 GUI 환경에서 터미널 세션을 시작할 때 나타남.  
 - 비로그인 쉘 세션용 시작 파일  
   
   | 파일 | 내용 |  
   | --- | --- |   
   | _/etc/bash.bashrc_ | 모든 사용자에게 적용되는 일반 환경설정 |  
   | _~/.bashrc_ | 개인 사용자 시작 파일. 일반 환경설정을 확장하거나 무시 가능 |  
 
 - 비로그인 쉘은 이 시작파일을 읽는 것뿐만 아니라 주로 로그인 쉘 같은 상위 프로세스로부터 환경값을 물려 받는다.  

### 시작 파일에는 어떤 것이 있을까?  

- 전형적인 .bash_profile  

```
# .bash_profile  

# Get the aliases and functions 
if [ -f ~/.bashrc ]; then  
       . ~/.bashrc
fi


# User specific environment and startup programs  

PATH=$PATH:$HOME/bin
export PATH
```
- # 기호로 시작하는 것은 **주석을 달아놓은 것**

```
if [ -f ~/.bashrc ]; then  
       . ~/.bashrc
fi
```
- 위는 **합성 명령어**라고 하는데 여기서 어떻게 로그인 쉘이 .bashrc 파일 내용을 가져오는지 볼 수 있다.  
```
If the file "~/.bashrc" exists, then
        read the "~/.bashrc" file.
```
- 시작 파일에 있는 나머지 내용은 PATH 변수와 함께 수행된다.  
- 커맨드라인에 명령어를 입력하면 쉘은 예를 들어, /bin/ls(ls 명령어의 전체 경로명)를 찾기 위해 컴퓨터 전체를 검색하는 것이 아니라 PATH 변수에 있는 디렉토리를 대상으로만 검색  

## 환경 편집  

### 텍스트 편집기  

- 그래픽 환경
 - GNOME - gedit  
 - KDE - kedit, kwrite, kate    

- 텍스트 기반  
 - nano  
 - vi  
 - emacs  

### 텍스트 편집기 사용하기  

- gedit 
```
[me@linuxbox ~]$ edit some_file  
```

- nano  
```
[me@linuxbox ~]$ nano .bashrc 
```
 - 화면 상단에 헤더, 중앙에는 편집할 텍스트, 아래에는 명령어 메뉴가 있다.  

### 변경 사항 적용하기  

- .bashrc 파일에 편집한 내용들은 터미널 세션을 종료하고 다시 새로 실행할 때까지 적용되지 않는다.  
 - .bashrc 파일은 최초 세션이 시작될 때 참조되는 파일이기 때문.  
 - 강제로 참조하도록 명령 가능  
   ```
   [me@linuxbox ~]$ source .bashrc
   ```  

